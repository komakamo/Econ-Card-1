<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚¨ã‚³ãƒãƒŸã‚¯ã‚¹ãƒ»ãƒã‚¹ã‚¿ãƒ¼ - çµŒæ¸ˆå­¦ã‚«ãƒ¼ãƒ‰ã‚²ãƒ¼ãƒ </title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">

    <!-- Tailwind CSS (ãƒ‡ã‚¶ã‚¤ãƒ³ç”¨) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['"Inter"', '"Noto Sans JP"', 'sans-serif'],
                        mono: ['"Noto Sans JP"', 'monospace'],
                    },
                    colors: {
                        brand: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                            900: '#0c4a6e',
                        }
                    }
                }
            }
        }
    </script>

    <!-- React & ReactDOM (ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯) -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel (JSXã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã§å®Ÿè¡Œã™ã‚‹ãŸã‚ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©) -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        /* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å®šç¾© */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }

        body {
            background-color: #f8fafc;
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%239C92AC' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E"), linear-gradient(to bottom right, #f1f5f9, #e2e8f0);
            min-height: 100vh;
        }
    </style>
</head>
<body class="text-slate-800 antialiased selection:bg-brand-100 selection:text-brand-900">
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        // --- ã‚¢ã‚¤ã‚³ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ (SVGåŸ‹ã‚è¾¼ã¿) ---
        // GitHub Pagesç­‰ã§å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªä¾å­˜ã«ã‚ˆã‚‹ã‚¨ãƒ©ãƒ¼ã‚’é˜²ããŸã‚SVGã‚’ç›´æ¥å®šç¾©
        const IconWallet = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1"/><path d="M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4"/></svg>
        );
        const IconTrendingUp = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="22 7 13.5 15.5 8.5 10.5 2 17"/><polyline points="16 7 22 7 22 13"/></svg>
        );
        const IconZap = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
        );
        const IconShield = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
        );
        const IconAlertCircle = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></svg>
        );
        const IconArrowRight = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
        );
        const IconRefreshCw = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M23 4v6h-6"/><path d="M1 20v-6h6"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>
        );
        const IconBookOpen = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
        );

        // --- ã‚²ãƒ¼ãƒ ãƒ‡ãƒ¼ã‚¿å®šç¾© ---

        const CARD_TYPES = {
            PRODUCTION: {
                label: 'ç”Ÿç”£',
                baseStyle: 'bg-white border-slate-200 hover:border-blue-300 hover:shadow-xl hover:shadow-blue-900/5 hover:-translate-y-1',
                headerStyle: 'bg-blue-50 text-blue-600 border-b border-blue-100',
                icon: <IconZap size={14} className="text-blue-500" />
            },
            POLICY: {
                label: 'æ”¿ç­–',
                baseStyle: 'bg-white border-slate-200 hover:border-emerald-300 hover:shadow-xl hover:shadow-emerald-900/5 hover:-translate-y-1',
                headerStyle: 'bg-emerald-50 text-emerald-600 border-b border-emerald-100',
                icon: <IconBookOpen size={14} className="text-emerald-500" />
            },
            ATTACK: {
                label: 'å¤–äº¤',
                baseStyle: 'bg-white border-slate-200 hover:border-rose-300 hover:shadow-xl hover:shadow-rose-900/5 hover:-translate-y-1',
                headerStyle: 'bg-rose-50 text-rose-600 border-b border-rose-100',
                icon: <IconShield size={14} className="text-rose-500" />
            },
        };

        const EVENTS = [
            {
                id: 1,
                name: 'åŸæ²¹ã‚·ãƒ§ãƒƒã‚¯',
                description: 'è³‡æºä¾¡æ ¼é«˜é¨°ã§ã‚ã‚‰ã‚†ã‚‹æ”¿ç­–ã‚³ã‚¹ãƒˆãŒ20%ä¸Šæ˜‡ã—ã¾ã™ã€‚',
                effect: { costMultiplier: 1.2 },
            },
            {
                id: 2,
                name: 'ç·Šç¸®è²¡æ”¿',
                description: 'è²¡æ”¿å†å»ºã®ãŸã‚åå…¥ãŒæ¯ã‚¿ãƒ¼ãƒ³3å…†å††æ¸›å°‘ã—ã¾ã™ã€‚',
                effect: { incomePenalty: 3 },
            },
            {
                id: 3,
                name: 'æŠ€è¡“é©æ–°ãƒ–ãƒ¼ãƒ ',
                description: 'ã‚«ãƒ¼ãƒ‰ã®çµŒæ¸ˆåŠ¹æœãŒ1.3å€ã«å¢—å¹…ã—ã¾ã™ã€‚',
                effect: { effectMultiplier: 1.3 },
            },
            {
                id: 4,
                name: 'æ™¯æ°—å¾Œé€€',
                description: 'ã‚«ãƒ¼ãƒ‰ã®çµŒæ¸ˆåŠ¹æœãŒ0.7å€ã«ç¸®å°ã—ã€è³‡é‡‘ç¹°ã‚ŠãŒå³ã—ããªã‚Šã¾ã™ã€‚',
                effect: { effectMultiplier: 0.7, costMultiplier: 1.1 },
            },
        ];

        const INITIAL_DECK = [
            {
                id: 1,
                name: 'è¨­å‚™æŠ•è³‡',
                cost: 30,
                type: 'PRODUCTION',
                effect: (me, opp) => ({ ...me, income: me.income + 5, gdp: me.gdp + 10 }),
                description: 'å·¥å ´ã®æ©Ÿæ¢°ãªã©ã‚’è³¼å…¥ã—ã€ç”Ÿç”£èƒ½åŠ›ã‚’é«˜ã‚ã¾ã™ã€‚',
                tip: 'ã€æŠ•è³‡ã®ä¹—æ•°åŠ¹æœã€‘æŠ•è³‡ã¯å°†æ¥ã®ç”Ÿç”£åŠ›ã¨æ‰€å¾—ã‚’å¢—ã‚„ã—ã¾ã™ã€‚',
                providesTag: 'infrastructure',
                combosWith: ['infrastructure']
            },
            {
                id: 2,
                name: 'æŠ€è¡“é©æ–°',
                cost: 60,
                type: 'PRODUCTION',
                effect: (me, opp) => ({ ...me, income: me.income + 10, gdp: me.gdp + 30 }),
                description: 'AIã‚„ãƒ­ãƒœãƒƒãƒˆãªã©ã®æ–°æŠ€è¡“ã‚’å°å…¥ã—ã€åŠ¹ç‡ã‚’åŠ‡çš„ã«ä¸Šã’ã¾ã™ã€‚',
                tip: 'ã€ã‚¤ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ã€‘æŠ€è¡“é€²æ­©ã¯çµŒæ¸ˆæˆé•·ã®æœ€å¤§ã®è¦å› ã®ä¸€ã¤ã§ã™ã€‚',
                providesTag: 'innovation',
                combosWith: ['education', 'infrastructure']
            },
            {
                id: 3,
                name: 'å…¬å…±äº‹æ¥­',
                cost: 40,
                type: 'POLICY',
                inflationChange: 1,
                supportChange: 8,
                effect: (me, opp) => ({ ...me, gdp: me.gdp + 25 }),
                description: 'é“è·¯ã‚„æ©‹ã‚’ä½œã‚Šã€é›‡ç”¨ã¨éœ€è¦ã‚’ç”Ÿã¿å‡ºã—ã¾ã™ã€‚',
                tip: 'ã€è²¡æ”¿æ”¿ç­–ã€‘æ”¿åºœãŒæ”¯å‡ºã‚’è¡Œã†ã“ã¨ã§ã€æœ‰åŠ¹éœ€è¦ã‚’å‰µå‡ºã—ã¾ã™ã€‚',
                providesTag: 'infrastructure'
            },
            {
                id: 4,
                name: 'é‡‘èç·©å’Œ',
                cost: 0,
                type: 'POLICY',
                inflationChange: 1.5,
                supportChange: 2,
                effect: (me, opp) => ({ ...me, money: me.money + 40 }),
                description: 'å¸‚å ´ã«ãŠé‡‘ã‚’æµã—è¾¼ã¿ã€ä¸€æ™‚çš„ã«è³‡é‡‘ã‚’æ½¤æ²¢ã«ã—ã¾ã™ã€‚',
                tip: 'ã€ãƒãƒã‚¿ãƒªãƒ¼ãƒ™ãƒ¼ã‚¹ã€‘é‡‘åˆ©ã‚’ä¸‹ã’ãŸã‚ŠãŠé‡‘ã®ä¾›çµ¦é‡ã‚’å¢—ã‚„ã—ã€æŠ•è³‡ã‚’ä¿ƒã—ã¾ã™ã€‚'
            },
            {
                id: 5,
                name: 'å¢—ç¨',
                cost: 0,
                type: 'POLICY',
                inflationChange: -1,
                supportChange: -12,
                effect: (me, opp) => ({ ...me, money: me.money + 60, gdp: me.gdp - 10 }),
                description: 'ç¨ç‡ã‚’ä¸Šã’è³‡é‡‘ã‚’ç¢ºä¿ã—ã¾ã™ãŒã€æ™¯æ°—ã¯å°‘ã—å†·ãˆè¾¼ã¿ã¾ã™ã€‚',
                tip: 'ã€ç·Šç¸®è²¡æ”¿ã€‘è²¡æºç¢ºä¿ã«ã¯æœ‰åŠ¹ã§ã™ãŒã€æ¶ˆè²»ã‚„æŠ•è³‡ã‚’æŠ‘åˆ¶ã™ã‚‹å‰¯ä½œç”¨ãŒã‚ã‚Šã¾ã™ã€‚'
            },
            {
                id: 6,
                name: 'ã‚¹ã‚¿ãƒ¼ãƒˆã‚¢ãƒƒãƒ—æ”¯æ´',
                cost: 20,
                type: 'PRODUCTION',
                supportChange: 4,
                effect: (me, opp) => ({ ...me, income: me.income + 8 }),
                description: 'èµ·æ¥­å®¶ã‚’æ”¯æ´ã—ã€æ–°ãŸãªãƒ“ã‚¸ãƒã‚¹ã‚’è‚²ã¦ã¾ã™ã€‚',
                tip: 'ã€æ–°ç”£æ¥­å‰µå‡ºã€‘æ–°ã—ã„ä¼æ¥­ã¯å°†æ¥ã®å¤§ããªç¨åæºã¨ãªã‚Šã¾ã™ã€‚',
                combosWith: ['innovation', 'education']
            },
            {
                id: 7,
                name: 'é–¢ç¨å¼•ãä¸Šã’',
                cost: 15,
                type: 'ATTACK',
                targetSupportChange: -5,
                targetEffect: (opp) => ({ ...opp, income: Math.max(0, opp.income - 5), money: Math.max(0, opp.money - 10) }),
                description: 'è¼¸å…¥å“ã«ç¨é‡‘ã‚’ã‹ã‘ã€ç›¸æ‰‹å›½ã®è¼¸å‡ºç”£æ¥­ã«ãƒ€ãƒ¡ãƒ¼ã‚¸ã‚’ä¸ãˆã¾ã™ã€‚',
                tip: 'ã€ä¿è­·è²¿æ˜“ã€‘è‡ªå›½ç”£æ¥­ã‚’å®ˆã‚‹ä¸€æ–¹ã§ã€è²¿æ˜“æˆ¦äº‰ã®ãƒªã‚¹ã‚¯ãŒã‚ã‚Šã¾ã™ã€‚'
            },
            {
                id: 8,
                name: 'äººæè‚²æˆ',
                cost: 25,
                type: 'PRODUCTION',
                supportChange: 5,
                effect: (me, opp) => ({ ...me, income: me.income + 3, gdp: me.gdp + 15 }),
                description: 'æ•™è‚²ã«æŠ•è³‡ã—ã€åŠ´åƒè€…ã®ã‚¹ã‚­ãƒ«ã‚’å‘ä¸Šã•ã›ã¾ã™ã€‚',
                tip: 'ã€äººçš„è³‡æœ¬ã€‘æ•™è‚²ãƒ¬ãƒ™ãƒ«ã®å‘ä¸Šã¯ã€é•·æœŸçš„ãªçµŒæ¸ˆæˆé•·ã«ä¸å¯æ¬ ã§ã™ã€‚',
                providesTag: 'education'
            },
        ];

        const WINNING_GDP = 300;
        const INFLATION_MIN = -5;
        const INFLATION_MAX = 15;

        const RATING_TIERS = [
            { label: 'AAA', threshold: 0, interestMultiplier: 1, eventDamageMultiplier: 1 },
            { label: 'BBB', threshold: 150, interestMultiplier: 1.25, eventDamageMultiplier: 1.1 },
            { label: 'CCC', threshold: 250, interestMultiplier: 1.6, eventDamageMultiplier: 1.25 },
            { label: 'D', threshold: 400, interestMultiplier: 2, eventDamageMultiplier: 1.5 },
        ];

        const getRatingByDebt = (debt = 0) => {
            const sorted = [...RATING_TIERS].sort((a, b) => b.threshold - a.threshold);
            const found = sorted.find(tier => debt >= tier.threshold);
            return found?.label ?? 'AAA';
        };

        const getRatingInfo = (rating = 'AAA') => RATING_TIERS.find(tier => tier.label === rating) ?? RATING_TIERS[0];

        const clampInflation = (value) => Math.min(INFLATION_MAX, Math.max(INFLATION_MIN, Number(value.toFixed(1))));

        const applyInflationDrift = (value) => {
            const drifted = value > 0 ? value - 0.3 : value < 0 ? value + 0.3 : 0;
            if (Math.abs(drifted) < 0.2) return 0;
            return clampInflation(drifted);
        };

        const applyInflationChange = (state, delta = 0) => {
            if (!delta) return state;
            return { ...state, inflation: clampInflation((state.inflation ?? 0) + delta) };
        };

        const calculateInflatedCost = (baseCost, inflationRate = 0) => {
            return Math.max(0, Math.round(baseCost * (1 + inflationRate / 100)));
        };

        const StatusPanel = ({ data, isEnemy, interest }) => {
            const inflationAlert = (value) => {
                if (value >= 12) return { label: 'ãƒã‚¤ãƒ‘ãƒ¼ã‚¤ãƒ³ãƒ•ãƒ¬', color: 'text-red-600 bg-red-50 ring-red-500/20' };
                if (value >= 8) return { label: 'é«˜ã‚¤ãƒ³ãƒ•ãƒ¬', color: 'text-orange-600 bg-orange-50 ring-orange-500/20' };
                if (value >= 4) return { label: 'ã‚¤ãƒ³ãƒ•ãƒ¬é€²è¡Œ', color: 'text-amber-600 bg-amber-50 ring-amber-500/20' };
                if (value <= -2) return { label: 'ãƒ‡ãƒ•ãƒ¬', color: 'text-blue-600 bg-blue-50 ring-blue-500/20' };
                return { label: 'å®‰å®š', color: 'text-emerald-600 bg-emerald-50 ring-emerald-500/20' };
            };

            const alert = inflationAlert(data.inflation);

            // Theme colors
            const theme = isEnemy ? {
                bg: 'bg-slate-50/80',
                border: 'border-slate-200',
                text: 'text-slate-600',
                accent: 'text-slate-500',
                highlight: 'bg-slate-200',
                bar: 'bg-slate-400'
            } : {
                bg: 'bg-white/90',
                border: 'border-blue-100',
                text: 'text-slate-800',
                accent: 'text-blue-600',
                highlight: 'bg-blue-50',
                bar: 'bg-blue-500'
            };

            return (
                <div className={`relative overflow-hidden p-5 rounded-2xl border-2 transition-all duration-300 backdrop-blur-sm ${theme.bg} ${theme.border} ${!isEnemy && 'shadow-xl shadow-blue-900/5 ring-2 ring-blue-500/5'}`}>
                    {/* Header */}
                    <div className="flex justify-between items-start mb-6">
                        <div className="flex items-center gap-3">
                            <div className={`w-10 h-10 rounded-xl flex items-center justify-center shadow-sm ${isEnemy ? 'bg-white text-slate-400 border border-slate-200' : 'bg-gradient-to-br from-blue-500 to-blue-600 text-white shadow-blue-200'}`}>
                                {isEnemy ? <IconZap size={20} /> : <IconWallet size={20} />}
                            </div>
                            <div>
                                <div className="flex items-center gap-2">
                                    <h3 className={`font-bold text-lg leading-none ${theme.text}`}>
                                        {isEnemy ? 'ãƒ©ã‚¤ãƒãƒ«å›½' : 'è‡ªå›½ (ã‚ãªãŸ)'}
                                    </h3>
                                    <span className={`text-[10px] font-extrabold px-1.5 py-0.5 rounded uppercase tracking-wider ${isEnemy ? 'bg-slate-200 text-slate-500' : 'bg-blue-100 text-blue-600'}`}>
                                        {isEnemy ? 'AI' : 'YOU'}
                                    </span>
                                </div>
                                <div className="text-xs text-slate-400 mt-1 font-medium flex items-center gap-1">
                                    ä¿¡ç”¨æ ¼ä»˜:
                                    <span className={`font-bold ${['AAA','BBB'].includes(data.rating) ? 'text-emerald-600' : 'text-amber-600'}`}>{data.rating}</span>
                                </div>
                            </div>
                        </div>

                        <div className="text-right">
                            <div className="text-[10px] uppercase tracking-wider text-slate-400 font-bold mb-0.5">GDP (Goal: 300)</div>
                            <div className={`text-3xl font-black tracking-tighter ${isEnemy ? 'text-slate-600' : 'text-blue-600'}`}>
                                {data.gdp}<span className="text-sm font-bold ml-1 text-slate-400">å…†</span>
                            </div>
                        </div>
                    </div>

                    {/* Stats Grid */}
                    <div className="grid grid-cols-2 gap-3 mb-4">
                        {/* Money */}
                        <div className="bg-white/50 p-3 rounded-xl border border-slate-100">
                            <div className="flex justify-between items-center mb-2">
                                <span className="text-xs font-bold text-slate-400 flex items-center gap-1">
                                    è³‡é‡‘æ®‹é«˜
                                </span>
                                <span className="text-sm font-bold font-mono text-slate-700">Â¥{data.money}</span>
                            </div>
                            <div className="w-full bg-slate-100 rounded-full h-1.5 overflow-hidden mb-2">
                                <div className={`h-full rounded-full transition-all duration-500 ${theme.bar}`} style={{ width: `${Math.min(100, data.money)}%` }}></div>
                            </div>
                            <div className="flex justify-between text-[10px] font-medium text-slate-400">
                                <span>åæ”¯: <span className="text-emerald-600">+{data.income}</span></span>
                                <span>åˆ©æ‰•: <span className="text-rose-500">-{interest}</span></span>
                            </div>
                        </div>

                        {/* Support */}
                        <div className="bg-white/50 p-3 rounded-xl border border-slate-100">
                            <div className="flex justify-between items-center mb-2">
                                <span className="text-xs font-bold text-slate-400">å›½æ°‘æ”¯æŒç‡</span>
                                <span className={`text-sm font-bold font-mono ${data.support < 30 ? 'text-rose-500' : 'text-slate-700'}`}>{data.support}%</span>
                            </div>
                            <div className="w-full bg-slate-100 rounded-full h-1.5 overflow-hidden">
                                <div className={`h-full rounded-full transition-all duration-500 ${data.support < 30 ? 'bg-rose-500' : 'bg-indigo-500'}`} style={{ width: `${data.support}%` }}></div>
                            </div>
                        </div>
                    </div>

                    {/* Footer Stats */}
                    <div className="flex gap-2">
                        <div className="flex-1 bg-slate-100/50 p-2 rounded-lg border border-slate-100 flex justify-between items-center">
                            <span className="text-[10px] font-bold text-slate-400">å‚µå‹™æ®‹é«˜</span>
                            <span className="text-xs font-bold text-slate-600">{data.debt}å…†</span>
                        </div>
                        <div className={`flex-1 p-2 rounded-lg border ring-1 flex justify-between items-center ${alert.color}`}>
                            <span className="text-[10px] font-bold opacity-70">ã‚¤ãƒ³ãƒ•ãƒ¬</span>
                            <span className="text-xs font-bold">{data.inflation.toFixed(1)}%</span>
                        </div>
                    </div>
                </div>
            );
        };

        // --- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ ---

        function EconomicCardGame() {
            const [turn, setTurn] = useState(1);
            const [gameState, setGameState] = useState('START'); // START, PLAYING, WON, LOST
            const [logs, setLogs] = useState(['ã‚²ãƒ¼ãƒ é–‹å§‹ï¼ç›®æ¨™ï¼šGDP 300å…†å††åˆ°é”']);
            const [activeEvent, setActiveEvent] = useState(null);
            const [lastTags, setLastTags] = useState([]);
            
            // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼çŠ¶æ…‹
            const [player, setPlayer] = useState({
                name: 'ã‚ãªãŸ',
                money: 100,
                income: 10,
                gdp: 0,
                inflation: 0,
                support: 70,
                debt: 0,
                rating: 'AAA',
                interestDue: 0,
            });
            const [playerHand, setPlayerHand] = useState([]);

            // AIçŠ¶æ…‹
            const [enemy, setEnemy] = useState({
                name: 'ãƒ©ã‚¤ãƒãƒ«å›½',
                money: 100,
                income: 10,
                gdp: 0,
                inflation: 0,
                support: 70,
                debt: 0,
                rating: 'AAA',
                interestDue: 0,
            });

            const getInflationAlert = (value) => {
                if (value >= 12) return { label: 'âš ï¸ ãƒã‚¤ãƒ‘ãƒ¼ã‚¤ãƒ³ãƒ•ãƒ¬æ‡¸å¿µ', color: 'text-red-700 bg-red-100 border-red-200' };
                if (value >= 8) return { label: 'ğŸ”¥ é«˜ã‚¤ãƒ³ãƒ•ãƒ¬', color: 'text-orange-700 bg-orange-100 border-orange-200' };
                if (value >= 4) return { label: 'â†—ï¸ ã‚¤ãƒ³ãƒ•ãƒ¬é€²è¡Œ', color: 'text-amber-700 bg-amber-50 border-amber-200' };
                if (value <= -2) return { label: 'â¬‡ï¸ ãƒ‡ãƒ•ãƒ¬åœ§åŠ›', color: 'text-blue-700 bg-blue-50 border-blue-200' };
                return { label: 'å®‰å®š', color: 'text-green-700 bg-green-50 border-green-200' };
            };

            const applyUnrestPenalty = (state, actorLabel) => {
                if (state.inflation < 8) return state;

                const angerLevel = state.inflation >= 12 ? 'è‡¨ç•Œ' : state.inflation >= 10 ? 'é«˜ã¾ã‚Š' : 'ä¸Šæ˜‡';
                const incomePenalty = state.inflation >= 12 ? 4 : 2;
                const gdpPenalty = state.inflation >= 10 ? 5 : 0;
                const penalizedState = {
                    ...state,
                    income: Math.max(0, state.income - incomePenalty),
                    gdp: Math.max(0, state.gdp - gdpPenalty),
                };

                addLog(`${actorLabel}: ã‚¤ãƒ³ãƒ•ãƒ¬é«˜é¨°ã«ã‚ˆã‚Šã€Œå›½æ°‘ã®ä¸æº€ã€ãŒ${angerLevel}ã€æ‰€å¾—-${incomePenalty}${gdpPenalty ? ` / GDP-${gdpPenalty}` : ''}`);
                return penalizedState;
            };

            const applySupportChange = (state, delta = 0, actorLabel, reason) => {
                if (!delta) return state;
                const prevSupport = state.support ?? 0;
                const nextSupport = Math.min(100, Math.max(0, prevSupport + delta));
                addLog(`${actorLabel}: ${reason}ã§æ”¯æŒç‡ãŒ${prevSupport}% â†’ ${nextSupport}%ã«å¤‰åŒ–`);
                return { ...state, support: nextSupport };
            };

            const applyRatingUpdate = (state, actorLabel) => {
                const nextRating = getRatingByDebt(state.debt ?? 0);
                if (state.rating === nextRating) return state;
                addLog(`${actorLabel}: å‚µå‹™æ®‹é«˜${state.debt}å…†ã«ã‚ˆã‚Šæ ¼ä»˜ã‘ãŒ${state.rating} â†’ ${nextRating}ã«å¤‰åŒ–`);
                return { ...state, rating: nextRating };
            };

            const getInterestForTurn = (state) => {
                const ratingInfo = getRatingInfo(state.rating);
                return Math.max(0, Math.round((state.interestDue ?? 0) * ratingInfo.interestMultiplier));
            };

            const applyInterestPayment = (state, actorLabel) => {
                const interest = getInterestForTurn(state);
                if (!interest) return state;
                const afterPayment = { ...state, money: Math.max(0, state.money - interest) };
                addLog(`${actorLabel}: å‚µå‹™åˆ©æ‰•ã„ã¨ã—ã¦ ${interest}å…†å††ã‚’æ”¯æ‰•ã„ã¾ã—ãŸï¼ˆæ ¼ä»˜ã‘: ${state.rating}ï¼‰`);
                return afterPayment;
            };

            // åˆæœŸåŒ–
            const startGame = () => {
                const event = chooseRandomEvent();
                setActiveEvent(event);
                setPlayer({ money: 80, income: 20, gdp: 0, inflation: 0, support: 70, debt: 0, rating: 'AAA', interestDue: 0 });
                setEnemy({ money: 80, income: 20, gdp: 0, inflation: 0, support: 70, debt: 0, rating: 'AAA', interestDue: 0 });
                setPlayerHand([]);
                setLastTags([]);
                setTurn(1);
                setLogs([`ğŸ“¢ ä»Šã‚¿ãƒ¼ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆ: ã€Œ${event.name}ã€ - ${event.description}`, 'ã‚²ãƒ¼ãƒ é–‹å§‹ï¼GDP 300å…†å††ã‚’ç›®æŒ‡ã›ï¼']);
                setGameState('PLAYING');
                drawCards(3);
            };

            const addLog = (msg) => {
                setLogs(prev => [msg, ...prev].slice(0, 5));
            };

            const chooseRandomEvent = () => EVENTS[Math.floor(Math.random() * EVENTS.length)];

            const selectTurnEvent = () => {
                const event = chooseRandomEvent();
                setActiveEvent(event);
                addLog(`ğŸ“¢ ä»Šã‚¿ãƒ¼ãƒ³ã®ã‚¤ãƒ™ãƒ³ãƒˆ: ã€Œ${event.name}ã€ - ${event.description}`);
            };

            // ã‚«ãƒ¼ãƒ‰ãƒ‰ãƒ­ãƒ¼æ©Ÿèƒ½
            const drawCards = (count) => {
                const newCards = [];
                for (let i = 0; i < count; i++) {
                    const randomCard = INITIAL_DECK[Math.floor(Math.random() * INITIAL_DECK.length)];
                    newCards.push({ ...randomCard, uniqueId: Math.random() });
                }
                setPlayerHand(prev => [...prev, ...newCards]);
            };

            const issueBonds = () => {
                if (gameState !== 'PLAYING') return;
                setPlayer(prev => {
                    const updated = {
                        ...prev,
                        money: prev.money + 50,
                        debt: (prev.debt ?? 0) + 50,
                        interestDue: (prev.interestDue ?? 0) + 5,
                    };
                    const rated = applyRatingUpdate(updated, 'ã‚ãªãŸ');
                    addLog('ã‚ãªãŸ: å›½å‚µç™ºè¡Œï¼è³‡é‡‘+50å…† / å‚µå‹™+50å…†ã€åˆ©æ‰•ã„5å…†/ã‚¿ãƒ¼ãƒ³ã‚’è¿½åŠ ');
                    return rated;
                });
            };

            const applyEventMultiplier = (prevState, nextState) => {
                if (!activeEvent?.effect?.effectMultiplier) return nextState;
                const multiplier = activeEvent.effect.effectMultiplier;
                const applyScale = (key) => {
                    const delta = nextState[key] - prevState[key];
                    return prevState[key] + Math.round(delta * multiplier);
                };
                return {
                    ...nextState,
                    money: applyScale('money'),
                    income: applyScale('income'),
                    gdp: applyScale('gdp'),
                };
            };

            const COMBO_MULTIPLIER = 1.3;

            const applyComboBonus = (prevState, nextState, matchedTags = []) => {
                if (!matchedTags.length) return nextState;
                const applyScale = (key) => {
                    const delta = nextState[key] - prevState[key];
                    return prevState[key] + Math.round(delta * COMBO_MULTIPLIER);
                };
                return {
                    ...nextState,
                    money: applyScale('money'),
                    income: applyScale('income'),
                    gdp: applyScale('gdp'),
                };
            };

            const getCardProvidedTags = (card) => {
                const tags = [];
                if (Array.isArray(card?.providesTags)) {
                    tags.push(...card.providesTags);
                }
                if (card?.providesTag) {
                    tags.push(card.providesTag);
                }
                return tags;
            };

            const withEventMultiplier = (setter) => (updater) => setter(prev => {
                const next = typeof updater === 'function' ? updater(prev) : updater;
                return applyEventMultiplier(prev, next);
            });

            const calculateAdjustedCost = (baseCost, inflationRate = 0) => {
                const inflated = calculateInflatedCost(baseCost, inflationRate);
                if (!activeEvent?.effect?.costMultiplier) return inflated;
                return Math.max(0, Math.round(inflated * activeEvent.effect.costMultiplier));
            };

            // ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ã‚¿ãƒ¼ãƒ³å‡¦ç†
            const playCard = (card) => {
                if (gameState !== 'PLAYING') return;

                const adjustedCost = calculateAdjustedCost(card.cost, player.inflation);
                const comboReadyTags = (card.combosWith ?? []).filter(tag => lastTags.includes(tag));
                const providedTags = getCardProvidedTags(card);

                let updatedEnemyState = null;

                if (player.money < adjustedCost) {
                    addLog(`è³‡é‡‘ä¸è¶³ã§ã™ï¼ˆå¿…è¦: ${adjustedCost}å…†å††ã€ã‚¤ãƒ³ãƒ•ãƒ¬å½±éŸ¿ã‚’åæ˜ ï¼‰`);
                    return;
                }

                if (comboReadyTags.length > 0) {
                    addLog(`ğŸ¯ ã‚³ãƒ³ãƒœç™ºå‹•ï¼${comboReadyTags.join(', ')}ã‚¿ã‚°ã¨ã®ç›¸ä¹—åŠ¹æœã§ã€Œ${card.name}ã€ã®åŠ¹æœãŒå¼·åŒ–ã•ã‚Œã¾ã™ã€‚`);
                }

                let updatedPlayerState = null;

                setPlayer(prev => {
                    const adjusted = calculateAdjustedCost(card.cost, prev.inflation);
                    const afterCost = { ...prev, money: prev.money - adjusted };

                    if (card.type === 'ATTACK') {
                        const afterSupport = applySupportChange(afterCost, card.supportChange, 'ã‚ãªãŸ', `ã€Œ${card.name}ã€ã®æ”¿æ²»çš„å½±éŸ¿`);
                        updatedPlayerState = afterSupport;
                        return afterSupport;
                    }

                    const afterEffect = card.effect(afterCost, enemy);
                    const comboBoosted = applyComboBonus(afterCost, afterEffect, comboReadyTags);
                    const afterEvent = applyEventMultiplier(afterCost, comboBoosted);
                    const afterInflation = applyInflationChange(afterEvent, card.inflationChange);
                    if (card.inflationChange) {
                        addLog(`ã‚ãªãŸ: ã€Œ${card.name}ã€ãŒç‰©ä¾¡ã«å½±éŸ¿ (${card.inflationChange > 0 ? '+' : ''}${card.inflationChange}%)`);
                    }
                    const afterUnrest = applyUnrestPenalty(afterInflation, 'ã‚ãªãŸ');
                    const afterSupport = applySupportChange(afterUnrest, card.supportChange, 'ã‚ãªãŸ', `ã€Œ${card.name}ã€ã®åŠ¹æœ`);
                    updatedPlayerState = afterSupport;
                    return afterSupport;
                });

                // åŠ¹æœç™ºå‹•
                if (card.type === 'ATTACK') {
                    const eventAwareSetEnemy = withEventMultiplier(setEnemy);
                    eventAwareSetEnemy(prev => {
                        const effected = card.targetEffect ? card.targetEffect(prev, updatedPlayerState) : prev;
                        const comboBoosted = applyComboBonus(prev, effected, comboReadyTags);
                        const unrested = applyUnrestPenalty(comboBoosted, 'ãƒ©ã‚¤ãƒãƒ«');
                        const withSupport = applySupportChange(unrested, card.targetSupportChange, 'ãƒ©ã‚¤ãƒãƒ«', `ã€Œ${card.name}ã€ã®å½±éŸ¿`);
                        updatedEnemyState = withSupport;
                        return withSupport;
                    });
                    addLog(`ã‚ãªãŸ: ã€Œ${card.name}ã€ã‚’ä½¿ç”¨ï¼ç›¸æ‰‹ã‚’å¦¨å®³ã—ãŸã€‚`);
                } else {
                    addLog(`ã‚ãªãŸ: ã€Œ${card.name}ã€ã‚’ä½¿ç”¨ã€‚çµŒæ¸ˆåŠ¹æœç™ºå‹•ï¼`);
                }

                // æ‰‹æœ­ã‹ã‚‰å‰Šé™¤
                setPlayerHand(prev => prev.filter(c => c.uniqueId !== card.uniqueId));

                if (providedTags.length > 0) {
                    setLastTags(prev => Array.from(new Set([...prev, ...providedTags])));
                }

                return checkWinCondition(updatedPlayerState ?? player, updatedEnemyState ?? enemy);
            };

            // ã‚¿ãƒ¼ãƒ³çµ‚äº†å‡¦ç† & AIã‚¿ãƒ¼ãƒ³
            const endTurn = () => {
                if (gameState !== 'PLAYING') return;

                // 1. åå…¥ã®å‡¦ç†ï¼ˆãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ï¼‰
                const driftedInflation = applyInflationDrift(player.inflation);
                const ratingInfo = getRatingInfo(player.rating);
                const incomePenalty = Math.round((activeEvent?.effect?.incomePenalty ?? 0) * ratingInfo.eventDamageMultiplier);
                const playerIncomeGain = Math.max(0, player.income - incomePenalty);
                let playerAfterIncome = {
                    ...player,
                    money: player.money + playerIncomeGain,
                    inflation: driftedInflation,
                };
                const interestPaid = getInterestForTurn(playerAfterIncome);
                playerAfterIncome = applyInterestPayment(playerAfterIncome, 'ã‚ãªãŸ');
                const ratedPlayer = applyRatingUpdate(playerAfterIncome, 'ã‚ãªãŸ');
                const unrestApplied = applyUnrestPenalty(ratedPlayer, 'ã‚ãªãŸ');
                setPlayer(unrestApplied);
                addLog(`ã‚¿ãƒ¼ãƒ³çµ‚äº†: åå…¥ +${playerIncomeGain}å…†å††${incomePenalty ? ` (ã‚¤ãƒ™ãƒ³ãƒˆã§-${incomePenalty})` : ''}ã€åˆ©æ‰•ã„ -${interestPaid}å…†å††ã€ã‚¤ãƒ³ãƒ•ãƒ¬ç‡ ${player.inflation.toFixed(1)} â†’ ${driftedInflation.toFixed(1)}%ã€æ ¼ä»˜ã‘ ${ratedPlayer.rating}`);

                // 2. å‹åˆ©åˆ¤å®š
                if (checkWinCondition()) return;

                // 3. AIã®ã‚¿ãƒ¼ãƒ³
                const aiEndedGame = aiTurn();

                // 4. æ¬¡ã®ã‚¿ãƒ¼ãƒ³ã®æº–å‚™
                if (!aiEndedGame) {
                    setTurn(prev => prev + 1);
                    drawCards(1);
                    selectTurnEvent();
                }

                setLastTags([]);
            };

            const aiTurn = () => {
                let latestEnemyState = null;

                setEnemy(prev => {
                    const drifted = applyInflationDrift(prev.inflation);
                    if (drifted !== prev.inflation) {
                        addLog(`ãƒ©ã‚¤ãƒãƒ«: ã‚¤ãƒ³ãƒ•ãƒ¬ç‡ ${prev.inflation.toFixed(1)}% â†’ ${drifted.toFixed(1)}% (è‡ªå‹•èª¿æ•´)`);
                    }
                    const afterDrift = { ...prev, inflation: drifted };
                    const ratingInfo = getRatingInfo(afterDrift.rating);
                    const incomePenalty = Math.round((activeEvent?.effect?.incomePenalty ?? 0) * ratingInfo.eventDamageMultiplier);
                    const aiIncomeGain = Math.max(0, afterDrift.income - incomePenalty);
                    let afterIncome = { ...afterDrift, money: afterDrift.money + aiIncomeGain };
                    afterIncome = applyInterestPayment(afterIncome, 'ãƒ©ã‚¤ãƒãƒ«');
                    const ratedEnemy = applyRatingUpdate(afterIncome, 'ãƒ©ã‚¤ãƒãƒ«');
                    const unrestAdjusted = applyUnrestPenalty(ratedEnemy, 'ãƒ©ã‚¤ãƒãƒ«');

                    const potentialActions = INITIAL_DECK.filter(c => calculateAdjustedCost(c.cost, unrestAdjusted.inflation) <= unrestAdjusted.money);

                    if (potentialActions.length === 0) {
                        addLog(`ãƒ©ã‚¤ãƒãƒ«: è³‡é‡‘ä¸è¶³ã®ãŸã‚è³‡é‡‘ã‚’æ¸©å­˜ã€‚`);
                        latestEnemyState = unrestAdjusted;
                        return unrestAdjusted;
                    }

                    const aiCard = potentialActions[Math.floor(Math.random() * potentialActions.length)];
                    const inflatedCost = calculateAdjustedCost(aiCard.cost, unrestAdjusted.inflation);
                    let afterPayment = { ...unrestAdjusted, money: unrestAdjusted.money - inflatedCost };

                    if (aiCard.type === 'ATTACK') {
                        const afterSupport = applySupportChange(afterPayment, aiCard.supportChange, 'ãƒ©ã‚¤ãƒãƒ«', `ã€Œ${aiCard.name}ã€ã®æ”¿æ²»çš„å½±éŸ¿`);
                        const eventAwareSetPlayer = withEventMultiplier(setPlayer);
                        eventAwareSetPlayer(prev => {
                            const effected = aiCard.targetEffect ? aiCard.targetEffect(prev, afterSupport) : prev;
                            const unrested = applyUnrestPenalty(effected, 'ã‚ãªãŸ');
                            return applySupportChange(unrested, aiCard.targetSupportChange, 'ã‚ãªãŸ', `ã€Œ${aiCard.name}ã€ã®å½±éŸ¿`);
                        });
                        addLog(`ãƒ©ã‚¤ãƒãƒ«: ã€Œ${aiCard.name}ã€ã‚’ä½¿ç”¨ï¼`);
                        latestEnemyState = afterSupport;
                        return afterSupport;
                    }

                    const afterEffect = applyEventMultiplier(afterPayment, aiCard.effect(afterPayment, player));
                    const afterInflation = applyInflationChange(afterEffect, aiCard.inflationChange);
                    if (aiCard.inflationChange) {
                        addLog(`ãƒ©ã‚¤ãƒãƒ«: ã€Œ${aiCard.name}ã€ã§ç‰©ä¾¡ãŒå¤‰å‹• (${aiCard.inflationChange > 0 ? '+' : ''}${aiCard.inflationChange}%)`);
                    }
                    addLog(`ãƒ©ã‚¤ãƒãƒ«: ã€Œ${aiCard.name}ã€ã‚’ä½¿ç”¨ã—æˆé•·ä¸­...`);
                    const unrested = applyUnrestPenalty(afterInflation, 'ãƒ©ã‚¤ãƒãƒ«');
                    const afterSupport = applySupportChange(unrested, aiCard.supportChange, 'ãƒ©ã‚¤ãƒãƒ«', `ã€Œ${aiCard.name}ã€ã®åŠ¹æœ`);
                    latestEnemyState = afterSupport;
                    return afterSupport;
                });

                return checkWinCondition(player, latestEnemyState ?? enemy);
            };

            const checkWinCondition = (nextPlayer = player, nextEnemy = enemy) => {
                if (gameState !== 'PLAYING') return false;

                if (nextPlayer.gdp >= WINNING_GDP) {
                    setGameState('WON');
                    addLog('ğŸ‰ ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼ã‚ãªãŸã®å›½ã®çµŒæ¸ˆãŒå‹åˆ©ã—ã¾ã—ãŸï¼');
                    return true;
                }

                if (nextEnemy.gdp >= WINNING_GDP) {
                    setGameState('LOST');
                    addLog('ğŸ’€ æ®‹å¿µ... ãƒ©ã‚¤ãƒãƒ«å›½ã«çµŒæ¸ˆè¦‡æ¨©ã‚’å¥ªã‚ã‚Œã¾ã—ãŸã€‚');
                    return true;
                }

                if (nextPlayer.support <= 0) {
                    setGameState('LOST');
                    addLog('ğŸ’€ æ”¯æŒç‡ãŒ0%ã«è½ã¡ã€æ”¿æ¨©ãŒå´©å£Šã—ã¦ã—ã¾ã„ã¾ã—ãŸã€‚');
                    return true;
                }

                if (nextEnemy.support <= 0) {
                    setGameState('WON');
                    addLog('ğŸ‰ ãƒ©ã‚¤ãƒãƒ«å›½ã®æ”¯æŒç‡ãŒå´©å£Šã—ã€ã‚ãªãŸã®å›½ãŒå„ªä½ã«ç«‹ã¡ã¾ã—ãŸï¼');
                    return true;
                }

                return false;
            };

            return (
                <div className="min-h-screen p-4 md:p-8 max-w-5xl mx-auto animate-fade-in pb-20 text-slate-800">

                    {/* ãƒ˜ãƒƒãƒ€ãƒ¼ */}
                    <header className="flex flex-col md:flex-row md:justify-between md:items-center mb-10 gap-4">
                        <div className="flex items-center gap-4">
                            <div className="bg-gradient-to-br from-slate-800 to-slate-900 text-white p-3.5 rounded-2xl shadow-xl shadow-slate-900/20 ring-4 ring-white">
                                <IconTrendingUp size={28} />
                            </div>
                            <div>
                                <h1 className="text-3xl font-black text-slate-800 tracking-tighter">Economics Master</h1>
                                <div className="flex items-center gap-3 mt-1">
                                    <div className="flex items-center gap-1.5 bg-white border border-slate-200 px-2 py-0.5 rounded-md shadow-sm">
                                        <span className="w-2 h-2 rounded-full bg-green-500 animate-pulse"></span>
                                        <span className="text-xs font-bold text-slate-600">TURN {turn}</span>
                                    </div>
                                    <span className="text-xs font-bold text-slate-400">GOAL: GDP {WINNING_GDP}T</span>
                                </div>
                            </div>
                        </div>
                        <button 
                            onClick={startGame}
                            className="group px-5 py-2.5 bg-white text-slate-600 border border-slate-200 rounded-xl hover:bg-slate-50 hover:border-slate-300 transition-all font-bold text-sm shadow-sm hover:shadow-md flex items-center gap-2"
                        >
                            <IconRefreshCw size={16} className="group-hover:rotate-180 transition-transform duration-500" />
                            {gameState === 'START' ? 'Start Game' : 'Reset Game'}
                        </button>
                    </header>

                    {activeEvent && gameState === 'PLAYING' && (
                        <div className="mb-8 animate-fade-in">
                            <div className="relative overflow-hidden bg-white border border-amber-100 p-1 rounded-2xl shadow-xl shadow-amber-900/5 ring-1 ring-amber-500/10">
                                <div className="bg-gradient-to-r from-amber-50/80 to-orange-50/80 backdrop-blur-md p-5 rounded-xl flex items-start md:items-center gap-5">
                                    <div className="flex-shrink-0 bg-white p-3 rounded-xl shadow-sm border border-amber-100 text-amber-500">
                                        <IconAlertCircle size={24} />
                                    </div>
                                    <div className="flex-grow">
                                        <div className="flex items-center gap-2 mb-1">
                                            <span className="bg-amber-100 text-amber-700 text-[10px] font-black px-2 py-0.5 rounded-full uppercase tracking-widest">News</span>
                                            <span className="text-xs font-bold text-amber-400 uppercase tracking-wider">Current Event</span>
                                        </div>
                                        <h3 className="text-xl font-black text-slate-800 tracking-tight mb-1">{activeEvent.name}</h3>
                                        <p className="text-sm text-slate-600 font-medium leading-relaxed">{activeEvent.description}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}

                    {gameState === 'START' && (
                        <div className="bg-white p-8 rounded-xl shadow-lg text-center mb-8 border-2 border-indigo-100 animate-fade-in">
                            <h2 className="text-2xl font-bold mb-4">çµŒæ¸ˆå­¦ã‚’ã‚«ãƒ¼ãƒ‰ã§å­¦ã¼ã†</h2>
                            <p className="mb-6 text-gray-600 leading-relaxed">
                                ã‚ãªãŸã¯å›½å®¶ã®ãƒªãƒ¼ãƒ€ãƒ¼ã§ã™ã€‚<br/>
                                ã€ŒæŠ•è³‡ã€ã€Œæ”¿ç­–ã€ã€Œå¤–äº¤ã€ã‚«ãƒ¼ãƒ‰ã‚’é§†ä½¿ã—ã¦ã€<br/>
                                ãƒ©ã‚¤ãƒãƒ«å›½ã‚ˆã‚Šå…ˆã«çµŒæ¸ˆæˆé•·ï¼ˆGDP 300å…†å††ï¼‰ã‚’é”æˆã—ã¦ãã ã•ã„ã€‚
                            </p>
                            <button 
                                onClick={startGame}
                                className="px-8 py-3 bg-indigo-600 text-white text-lg rounded-full font-bold shadow-lg hover:bg-indigo-700 hover:scale-105 transition transform"
                            >
                                ã‚¹ã‚¿ãƒ¼ãƒˆï¼
                            </button>
                        </div>
                    )}

                    {/* ã‚²ãƒ¼ãƒ ã‚¨ãƒªã‚¢ */}
                    {(gameState === 'PLAYING' || gameState === 'WON' || gameState === 'LOST') && (
                        <div className="space-y-6 animate-fade-in">
                            
                            {/* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚¨ãƒªã‚¢ (Grid) */}
                            <div className="grid md:grid-cols-2 gap-4">
                                <StatusPanel data={player} isEnemy={false} interest={getInterestForTurn(player)} />
                                <StatusPanel data={enemy} isEnemy={true} interest={getInterestForTurn(enemy)} />
                            </div>

                            {/* ãƒ­ã‚°ã¨å‹åˆ©ç”»é¢ */}
                            <div className="relative min-h-[120px] max-h-[180px] bg-slate-900 rounded-2xl p-4 overflow-y-auto shadow-inner ring-1 ring-white/10 font-mono text-sm leading-relaxed scrollbar-thin scrollbar-thumb-slate-700 scrollbar-track-transparent group">
                                {gameState === 'WON' && (
                                    <div className="absolute inset-0 bg-white/95 backdrop-blur-md flex flex-col items-center justify-center z-20 rounded-2xl animate-fade-in">
                                        <div className="bg-yellow-100 p-4 rounded-full mb-4">
                                            <IconTrendingUp size={48} className="text-yellow-600" />
                                        </div>
                                        <h2 className="text-4xl font-black text-slate-800 mb-2 tracking-tight">VICTORY!</h2>
                                        <p className="font-medium text-slate-500">ã‚ãªãŸã®çµŒæ¸ˆæ”¿ç­–ã¯æˆåŠŸã—ã¾ã—ãŸï¼</p>
                                        <button onClick={startGame} className="mt-6 px-6 py-3 bg-brand-600 text-white rounded-xl font-bold shadow-lg shadow-brand-500/30 hover:bg-brand-700 transition-all">Play Again</button>
                                    </div>
                                )}
                                {gameState === 'LOST' && (
                                    <div className="absolute inset-0 bg-slate-900/95 backdrop-blur-md flex flex-col items-center justify-center z-20 rounded-2xl animate-fade-in text-white">
                                        <div className="bg-slate-800 p-4 rounded-full mb-4 border border-slate-700">
                                            <IconAlertCircle size={48} className="text-rose-500" />
                                        </div>
                                        <h2 className="text-4xl font-black text-rose-500 mb-2 tracking-tight">DEFEAT...</h2>
                                        <p className="text-slate-400">çµŒæ¸ˆç«¶äº‰ã«æ•—åŒ—ã—ã¾ã—ãŸ...</p>
                                        <button onClick={startGame} className="mt-6 px-6 py-3 bg-white text-slate-900 rounded-xl font-bold hover:bg-slate-200 transition-all">Try Again</button>
                                    </div>
                                )}
                                <div className="space-y-1.5 opacity-80 group-hover:opacity-100 transition-opacity">
                                    {logs.map((log, i) => (
                                        <div key={i} className="flex gap-3 text-slate-300 border-b border-slate-800/50 pb-1.5 last:border-0 last:pb-0">
                                            <span className="text-slate-600 text-xs mt-1 select-none shrink-0">{'>'}</span>
                                            <span>{log}</span>
                                        </div>
                                    ))}
                                </div>
                            </div>


                            {/* æ‰‹æœ­ã‚¨ãƒªã‚¢ */}
                            <div>
                                <div className="flex justify-between items-end mb-4">
                                    <h3 className="text-sm font-bold text-gray-500 uppercase tracking-wider pl-1">Hand Cards (Click to Play)</h3>
                                    <div className="flex gap-2">
                                        <button
                                            onClick={issueBonds}
                                            disabled={gameState !== 'PLAYING'}
                                            className="bg-amber-500 text-white px-4 py-2 rounded-xl font-bold hover:bg-amber-600 hover:shadow-lg hover:-translate-y-0.5 transition-all disabled:opacity-50 disabled:translate-y-0 disabled:shadow-none flex items-center gap-2"
                                        >
                                            <span className="text-xs bg-white/20 px-1.5 py-0.5 rounded">è³‡é‡‘èª¿é”</span>
                                            å›½å‚µç™ºè¡Œ
                                        </button>
                                        <button
                                            onClick={endTurn}
                                            disabled={gameState !== 'PLAYING'}
                                            className="bg-slate-800 text-white px-6 py-2 rounded-xl font-bold hover:bg-slate-700 hover:shadow-lg hover:-translate-y-0.5 transition-all disabled:opacity-50 disabled:translate-y-0 disabled:shadow-none flex items-center gap-2"
                                        >
                                            ã‚¿ãƒ¼ãƒ³çµ‚äº† <IconArrowRight size={16} />
                                        </button>
                                    </div>
                                </div>
                                
                                <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                                    {playerHand.map((card) => {
                                        const typeInfo = CARD_TYPES[card.type];
                                        const inflatedCost = calculateAdjustedCost(card.cost, player.inflation);
                                        const canAfford = player.money >= inflatedCost;
                                        const comboReadyTags = (card.combosWith ?? []).filter(tag => lastTags.includes(tag));
                                        const providesTags = getCardProvidedTags(card);
                                        return (
                                            <button
                                                key={card.uniqueId}
                                                onClick={() => playCard(card)}
                                                disabled={!canAfford || gameState !== 'PLAYING'}
                                                className={`
                                                    relative text-left group
                                                    flex flex-col h-full rounded-xl border transition-all duration-300 overflow-hidden
                                                    ${typeInfo.baseStyle}
                                                    ${canAfford ? 'cursor-pointer' : 'opacity-60 cursor-not-allowed grayscale'}
                                                `}
                                            >
                                                {/* Card Header */}
                                                <div className={`px-4 py-3 flex justify-between items-center ${typeInfo.headerStyle}`}>
                                                    <span className="text-[10px] font-black uppercase tracking-wider flex items-center gap-1.5">
                                                        {typeInfo.icon} {typeInfo.label}
                                                    </span>
                                                    <div className="flex flex-col items-end leading-none">
                                                        <span className="font-mono text-lg font-black tracking-tighter">Â¥{inflatedCost}</span>
                                                    </div>
                                                </div>

                                                {/* Card Body */}
                                                <div className="p-4 flex flex-col flex-grow bg-white/60">
                                                    <h4 className="font-bold text-slate-800 text-sm mb-2 leading-tight min-h-[2.5em] flex items-center">
                                                        {card.name}
                                                    </h4>

                                                    <p className="text-xs text-slate-600 mb-4 flex-grow leading-relaxed">
                                                        {card.description}
                                                    </p>

                                                    <div className="space-y-1.5">
                                                        {/* Cost Info */}
                                                        {inflatedCost !== card.cost && (
                                                            <div className="text-[10px] text-amber-600 bg-amber-50 px-2 py-1 rounded border border-amber-100 flex items-center gap-1">
                                                                <IconAlertCircle size={10} />
                                                                ã‚³ã‚¹ãƒˆå¤‰å‹•: Â¥{card.cost} â†’ Â¥{inflatedCost}
                                                            </div>
                                                        )}

                                                        {/* Tags */}
                                                        {(comboReadyTags.length > 0 || providesTags.length > 0) && (
                                                            <div className="flex flex-wrap gap-1">
                                                                {comboReadyTags.map(tag => (
                                                                     <span key={tag} className="bg-rose-100 text-rose-600 border border-rose-200 px-1.5 py-0.5 rounded text-[10px] font-bold">
                                                                        â˜… {tag}
                                                                     </span>
                                                                ))}
                                                                {providesTags.map(tag => (
                                                                     <span key={tag} className="bg-slate-100 text-slate-500 border border-slate-200 px-1.5 py-0.5 rounded text-[10px] font-medium">
                                                                        + {tag}
                                                                     </span>
                                                                ))}
                                                            </div>
                                                        )}
                                                    </div>
                                                </div>

                                                {/* Footer / Tip */}
                                                <div className="px-4 py-3 bg-slate-50/50 border-t border-slate-100 text-[10px] text-slate-500 leading-tight">
                                                    <span className="font-bold text-slate-400 block mb-1 text-[9px] uppercase">MEMO</span>
                                                    {card.tip}
                                                </div>

                                                {!canAfford && (
                                                    <div className="absolute inset-0 bg-slate-100/50 flex items-center justify-center backdrop-blur-[1px] z-10">
                                                        <span className="bg-slate-800 text-white text-xs font-bold px-3 py-1.5 rounded-full shadow-lg">è³‡é‡‘ä¸è¶³</span>
                                                    </div>
                                                )}
                                            </button>
                                        );
                                    })}
                                    {playerHand.length === 0 && (
                                        <div className="col-span-full py-12 flex flex-col items-center justify-center text-slate-400 border-2 border-dashed border-slate-200 rounded-2xl bg-slate-50/50">
                                            <IconBookOpen className="mb-2 opacity-50" size={32} />
                                            <p className="text-sm font-medium">æ‰‹æœ­ãŒã‚ã‚Šã¾ã›ã‚“</p>
                                            <p className="text-xs mt-1">ã‚¿ãƒ¼ãƒ³ã‚’çµ‚äº†ã—ã¦æ¬¡ã®ã‚«ãƒ¼ãƒ‰ã‚’å¼•ã„ã¦ãã ã•ã„</p>
                                        </div>
                                    )}
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        }

        // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<EconomicCardGame />);
    </script>
</body>
</html>
